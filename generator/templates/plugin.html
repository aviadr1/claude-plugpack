{% extends "base.html" %}

{% block title %}{{ plugin.name }}{% endblock %}
{% block description %}{{ plugin.description }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Breadcrumb -->
    <nav class="mb-6 text-sm">
        <ol class="flex items-center gap-2 text-gray-500">
            <li><a href="/" class="hover:text-gray-700">Home</a></li>
            <li>/</li>
            <li><a href="/plugins/" class="hover:text-gray-700">Plugins</a></li>
            <li>/</li>
            <li><a href="/categories/{{ plugin.category }}.html" class="hover:text-gray-700 capitalize">{{ plugin.category }}</a></li>
            <li>/</li>
            <li class="text-gray-900">{{ plugin.name }}</li>
        </ol>
    </nav>

    <!-- Plugin Header -->
    <div class="bg-white rounded-xl border border-gray-200 p-6 mb-6">
        <div class="flex items-start justify-between mb-4">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">{{ plugin.name }}</h1>
                {% if plugin.author_name %}
                <p class="text-gray-500">by {{ plugin.author_name }}</p>
                {% endif %}
            </div>

            <div class="flex items-center gap-2">
                {% if plugin.is_verified %}
                <span class="px-3 py-1 text-sm font-medium bg-green-100 text-green-700 rounded-full flex items-center gap-1">
                    <i data-feather="check-circle" class="w-4 h-4"></i>
                    Verified
                </span>
                {% endif %}
                {% set badge = plugin.maintenance_status|maintenance_badge %}
                <span class="px-3 py-1 text-sm font-medium {{ badge.class }} rounded-full">
                    {{ badge.text }}
                </span>
            </div>
        </div>

        <p class="text-lg text-gray-600 mb-6">{{ plugin.description }}</p>

        <!-- Install Command -->
        <div class="bg-gray-900 rounded-lg p-4 mb-6" x-data="{ copied: false }">
            <div class="flex items-center justify-between">
                <code class="text-green-400 font-mono">/install {{ plugin.name }}</code>
                <button
                    @click="navigator.clipboard.writeText('/install {{ plugin.name }}'); copied = true; setTimeout(() => copied = false, 2000)"
                    class="text-gray-400 hover:text-white transition-colors">
                    <span x-show="!copied"><i data-feather="copy" class="w-5 h-5"></i></span>
                    <span x-show="copied" x-cloak class="text-green-400"><i data-feather="check" class="w-5 h-5"></i></span>
                </button>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
            <div class="text-center p-3 bg-gray-50 rounded-lg">
                <div class="text-2xl font-bold text-gray-900">{{ plugin.github_stars|format_number if plugin.github_stars else '0' }}</div>
                <div class="text-sm text-gray-500">Stars</div>
            </div>
            <div class="text-center p-3 bg-gray-50 rounded-lg">
                <div class="text-2xl font-bold text-gray-900">{{ plugin.github_forks|format_number if plugin.github_forks else '0' }}</div>
                <div class="text-sm text-gray-500">Forks</div>
            </div>
            <div class="text-center p-3 bg-gray-50 rounded-lg">
                <div class="text-2xl font-bold text-gray-900">{{ plugin.open_issues if plugin.open_issues else '0' }}</div>
                <div class="text-sm text-gray-500">Issues</div>
            </div>
            <div class="text-center p-3 bg-gray-50 rounded-lg">
                <div class="text-2xl font-bold text-gray-900 capitalize">{{ plugin.category }}</div>
                <div class="text-sm text-gray-500">Category</div>
            </div>
        </div>
    </div>

    <!-- Details -->
    <div class="grid md:grid-cols-3 gap-6 mb-6">
        <!-- Main Info -->
        <div class="md:col-span-2 bg-white rounded-xl border border-gray-200 p-6">
            <h2 class="text-xl font-bold text-gray-900 mb-4">Details</h2>

            <dl class="space-y-4">
                {% if plugin.version and plugin.version != '0.0.0' %}
                <div class="flex justify-between py-2 border-b border-gray-100">
                    <dt class="text-gray-500">Version</dt>
                    <dd class="font-medium text-gray-900">{{ plugin.version }}</dd>
                </div>
                {% endif %}

                <div class="flex justify-between py-2 border-b border-gray-100">
                    <dt class="text-gray-500">Category</dt>
                    <dd>
                        <a href="/categories/{{ plugin.category }}.html" class="font-medium text-claude-600 hover:text-claude-700 capitalize">
                            {{ plugin.category }}
                        </a>
                    </dd>
                </div>

                {% if plugin.scraped_from %}
                <div class="flex justify-between py-2 border-b border-gray-100">
                    <dt class="text-gray-500">Source</dt>
                    <dd class="font-medium text-gray-900">{{ plugin.scraped_from }}</dd>
                </div>
                {% endif %}

                <div class="flex justify-between py-2 border-b border-gray-100">
                    <dt class="text-gray-500">Last Updated</dt>
                    <dd class="font-medium text-gray-900">{{ plugin.scraped_at|time_ago }}</dd>
                </div>
            </dl>
        </div>

        <!-- Links -->
        <div class="bg-white rounded-xl border border-gray-200 p-6">
            <h2 class="text-xl font-bold text-gray-900 mb-4">Links</h2>

            <div class="space-y-3">
                {% if plugin.repository_url %}
                <a href="{{ plugin.repository_url }}" target="_blank" rel="noopener"
                   class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                    <i data-feather="github" class="w-5 h-5 text-gray-700"></i>
                    <span class="font-medium text-gray-700">View on GitHub</span>
                    <i data-feather="external-link" class="w-4 h-4 text-gray-400 ml-auto"></i>
                </a>
                {% endif %}

                {% if plugin.homepage_url %}
                <a href="{{ plugin.homepage_url }}" target="_blank" rel="noopener"
                   class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                    <i data-feather="globe" class="w-5 h-5 text-gray-700"></i>
                    <span class="font-medium text-gray-700">Homepage</span>
                    <i data-feather="external-link" class="w-4 h-4 text-gray-400 ml-auto"></i>
                </a>
                {% endif %}

                {% if plugin.source_url %}
                <a href="{{ plugin.source_url }}" target="_blank" rel="noopener"
                   class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                    <i data-feather="file-text" class="w-5 h-5 text-gray-700"></i>
                    <span class="font-medium text-gray-700">Source</span>
                    <i data-feather="external-link" class="w-4 h-4 text-gray-400 ml-auto"></i>
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Related Plugins -->
    {% if related_plugins %}
    <div class="bg-white rounded-xl border border-gray-200 p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">Related Plugins</h2>

        <div class="grid sm:grid-cols-2 gap-4">
            {% for related in related_plugins %}
            <a href="/plugins/{{ related.slug }}.html"
               class="group flex items-start gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                <div class="flex-1 min-w-0">
                    <h3 class="font-medium text-gray-900 group-hover:text-claude-600">{{ related.name }}</h3>
                    <p class="text-sm text-gray-500 truncate">{{ related.description }}</p>
                </div>
                {% if related.github_stars %}
                <div class="flex items-center gap-1 text-sm text-gray-400">
                    <i data-feather="star" class="w-4 h-4"></i>
                    {{ related.github_stars|format_number }}
                </div>
                {% endif %}
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
